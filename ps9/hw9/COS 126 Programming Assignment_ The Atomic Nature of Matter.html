
<!-- saved from url=(0081)http://www.cs.princeton.edu/courses/archive/fall16/cos126/assignments/atomic.html -->
<html class="gr__cs_princeton_edu"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>COS 126 Programming Assignment: The Atomic Nature of Matter
</title>
<script type="text/javascript" src="./COS 126 Programming Assignment_ The Atomic Nature of Matter_files/MathJax.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>


<body data-gr-c-s-loaded="true"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
<h3>COS 126 Programming Assignment</h3>
<h2>The Atomic Nature of Matter</h2>


<p>
Re-affirm the atomic nature of matter by tracking the motion of particles
undergoing Brownian motion, fitting this data to Einstein's model, 
and estimating Avogadro's number.

</p><p><b>Historical perspective.</b>
The atom played a central role in 20th century physics and chemistry,
but prior to 1908 the reality of atoms and molecules was not universally accepted.
In 1827, the botanist Robert Brown observed the random erratic motion of
microscopic particles suspended within the vacuoles of pollen grains.
This motion would later become known as <em>Brownian motion</em>.
Einstein hypothesized that this motion
was the result of millions of even smaller particles—atoms and molecules—colliding
with the larger particles. 
</p><p>

</p><center>
<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" width="320" height="240" id="Yourfilename" align="">
<param name="movie" value="atomic-files/brownian_motion_my.swf"> <param name="quality" value="high"> <param name="bgcolor" value="#ffffff"> <embed src="atomic-files/brownian_motion_my.swf" quality="high" bgcolor="#ffffff" width="360" height="260" name="Yourfilename" align="" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer"> </object>
</center>

<p>
In one of his "miraculous year" (1905) papers, Einstein formulated a
quantitative theory of Brownian motion in an attempt to justify the "existence
of atoms of definite finite size."
His theory provided experimentalists with a method to
count molecules with an ordinary microscope by observing their
collective effect on a larger immersed particle.
In 1908 Jean Baptiste Perrin used the recently invented ultramicroscope
to experimentally validate Einstein's kinetic theory of Brownian motion,
thereby providing the first direct evidence supporting
the atomic nature of matter.
His experiment also provided
one of the earliest estimates of Avogadro's number.
For this work, Perrin won the 1926 Nobel Prize in physics.
<!-- [According to some, this experiment explains
"all of chemistry and most of physics." :) ]
-->

</p><p><b>The problem.</b>
In this assignment, you will redo a version of Perrin's experiment.
Your job is greatly simplified because with modern video and computer
technology—in conjunction with your programming skills—it is possible
to accurately measure and track the motion of an immersed
particle undergoing Brownian motion.
We supply video microscopy data of polystyrene spheres ("beads")
suspended in water, undergoing Brownian motion.
Your task is to write a program to analyze this data, determine
how much each bead moves between observations, 
fit this data to Einstein's model, and estimate Avogadro's number.

</p><p><b>The data.</b>&nbsp;
We provide 
<!--<a href = "ftp://ftp.cs.princeton.edu/pub/cs126/atomic">-->
10 datasets,
<!--</a>,-->
obtained by William Ryu using fluorescent imaging.
Each dataset is stored in a subdirectory (named <tt>run_1</tt> through <tt>run_10</tt>)
and contains a sequence of two hundred 640-by-480 color JPEG images
(named <tt>frame00000.jpg</tt> through <tt>frame00199.jpg</tt>).

</p><p>
<!-- Here is a <a href = "atomic.avi">movie</a> [35MB] -->
Here is a movie [ <a href="http://www.cs.princeton.edu/courses/archive/fall16/cos126/assignments/atomic-files/atomic.avi">avi</a> · <a href="http://www.cs.princeton.edu/courses/archive/fall16/cos126/assignments/atomic-files/atomic.mov">mov</a> ]
of several beads undergoing Brownian motion.
Below is a typical raw image (left) and a cleaned up version (right) using
thresholding, as described below.

</p><p>
</p><center>
<blockquote>
<table border="0" cellpadding="2" cellspacing="0">
<tbody><tr>
<td>&nbsp;&nbsp;&nbsp;
</td><td><img src="./COS 126 Programming Assignment_ The Atomic Nature of Matter_files/atomic-beads.jpg" width="320" height="240" alt="frame of polystyrene spheres immersed in water">
</td><td>
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;
</td><td><img src="./COS 126 Programming Assignment_ The Atomic Nature of Matter_files/atomic-beads-threshold.jpg" width="320" height="240" alt="threshold frame of polystyrene spheres immersed in water">
</td></tr>
</tbody></table>
</blockquote>
</center>
	
<p>

Each image shows a two-dimensional cross section of a microscope
slide.
<!--  at a depth of 50 microns <font color=green>(5*10<sup>-8</sup> meters)</font>. -->
The beads move in and out of the microscope's field of view
(the <em>x</em>- and <em>y</em>-directions).
Beads also move in the <em>z</em>-direction, so they can move in and out of the
microscope's depth of focus; this results in halos, and it can also result
in beads completely disappearing from the image.

<!-- 
<ul>
<p><li> <font color=green>Density of water = 1.00g/cm^3. (not needed for calculations)</font>
<p><Li> <font color=green>Density of beads (latex) = 1.05g/cm^3. (not needed for calculations)</font>
</ul>
-->



</p><p><b>I. Particle identification.</b>
The first challenge is to identify the beads amidst the noisy data.
Each image is 640-by-480 pixels,
and each pixel is represented by a <tt>Color</tt> object which needs to be 
converted to a luminance value ranging from 0.0 (black)
to 255.0 (white).
Whiter pixels correspond to beads (foreground)
and blacker pixels to water (background).
We break the problem into three pieces: (i) read an image,
(ii) classify the pixels as foreground or background, and (iii)
find the disc-shaped clumps of foreground pixels that constitute each bead.

</p><ul>

<p></p><li><em>Reading the image.</em> Use the 
<a href="http://introcs.cs.princeton.edu/java/stdlib/javadoc/Picture.html">Picture</a>
data type from Section 3.1 to read the image.
By convention, pixels are measured from left-to-right (<em>x</em>-coordinate),
and from top-to-bottom (<em>y</em>-coordinate).


<p></p></li><li><em>Classifying the pixels as foreground or background.</em>
We use a simple, but effective, technique known as <em>thresholding</em> to 
separate the pixels into foreground and background components:
all pixels with monochrome luminance values strictly below some threshold 
<em>tau</em> are considered background; all others are considered foreground.
The two pictures above illustrates the original frame (above left) and 
the same frame after thresholding (above right), using
<em>tau</em> = 180.0.
<!-- This value of <em>tau</em> results in an effective cut for the supplied data.  -->

<p></p></li><li><em>Finding the blobs.</em>
A polystyrene bead is represented by a disc-like shape of 
at least some minimum number <em>min</em> (typically 25) of connected foreground pixels.
A <em>blob</em> or <em>connected component</em>
is a maximal set of connected foreground pixels, regardless of its shape
or size.
We will refer to any blob containing at least
<em>min</em> pixels as a <em>bead</em>.
The <em>center of mass</em> of a blob (or bead) is the average
of the <em>x</em>- and <em>y</em>-coordinates of its constituent pixels.

<p>
Create a helper data type <tt>Blob</tt> that has the following API.

</p><p>
</p><blockquote>
<pre><b>public class Blob {</b>
    <b>public        Blob()</b>                     <font color="gray">//  creates an empty blob</font>
    <b>public   void add(int x, int y)</b>          <font color="gray">//  adds pixel (x, y) to this blob</font>
    <b>public   int  mass()</b>                     <font color="gray">//  returns the number of pixels added to this blob</font>
    <b>public double distanceTo(Blob that)</b>      <font color="gray">//  returns the Euclidean distance between the center of masses of the two blobs</font>
    <b>public String toString()</b>                 <font color="gray">//  returns a string representation of this blob (see below)</font>
    <b>public static void main(String[] args)</b>   <font color="gray">//  unit tests all methods in the Blob data type</font>
<b>}</b>
</pre></blockquote>

<p><em>String representation.</em>
The <tt>toString()</tt> method should return a string containing the blob's mass; followed by whitespace;
followed by the <em>x</em>- and <em>y</em>-coordinates of the blob's center of mass,
enclosed in parentheses, separated with a comma, and using four digits of precision after the decimal point.

</p><p>
Next, write a data type <tt>BeadFinder</tt> that has the following API.
Use <em>depth-first search</em> to efficiently identify the blobs and beads.

</p><p>
</p><blockquote>
<pre><b>public class BeadFinder {</b>
    <font color="gray">//  finds all blobs in the specified picture using luminance threshold tau</font>
    <b>public BeadFinder(Picture picture, double tau)</b>

    <font color="gray">//  returns all beads (blobs with &gt;= min pixels)</font>
    <b>public Blob[] getBeads(int min)</b>

    <font color="gray">//  unit tests the BeadFinder data type, as described below</font>
    <b>public static void main(String[] args)</b>
<b>}</b>
</pre></blockquote>

The <tt>main()</tt> method should take an integer <em>min</em>,
a floating-point number <em>tau</em>,
and the name of a JPEG file as command-line arguments; create 
a <tt>BeadFinder</tt> object using a luminance threshold of <em>tau</em>;
and and print all beads (blobs containing at least <em>min</em> pixels),
as shown here:

<blockquote><pre>% <b>java-introcs BeadFinder 0 180.0 run_1/frame00001.jpg</b>
29 (214.7241,  82.8276)
36 (223.6111, 116.6667)
 1 (254.0000, 223.0000)
42 (260.2381, 234.8571)
35 (266.0286, 315.7143)
31 (286.5806, 355.4516)
37 (299.0541, 399.1351)
35 (310.5143, 214.6000)
31 (370.9355, 365.4194)
28 (393.5000, 144.2143)
27 (431.2593, 380.4074)
36 (477.8611,  49.3889)
38 (521.7105, 445.8421)
35 (588.5714, 402.1143)
13 (638.1538, 155.0000)

% <b>java-introcs BeadFinder 25 180.0 run_1/frame00001.jpg</b>
29 (214.7241,  82.8276)
36 (223.6111, 116.6667)
42 (260.2381, 234.8571)
35 (266.0286, 315.7143)
31 (286.5806, 355.4516)
37 (299.0541, 399.1351)
35 (310.5143, 214.6000)
31 (370.9355, 365.4194)
28 (393.5000, 144.2143)
27 (431.2593, 380.4074)
36 (477.8611,  49.3889)
38 (521.7105, 445.8421)
35 (588.5714, 402.1143)
</pre></blockquote>

In the sample frame, there are 15 blobs, 13 of which are beads.


</li></ul>


<p><b>II. Particle tracking.</b>
The next step is to determine how far a bead moves from one time step <em>t</em>
to the next <em>t</em> + Δ<em>t</em>. For our data, Δ<em>t</em> = 0.5 seconds per frame.
We assume the data is such that each bead moves a relatively
small amount, and that two beads do not collide. (We must, however,
account for the possibility that the bead disappears from the frame,
either by departing the microscope's field of view in the <em>x</em>- or
<em>y</em>- direction,
or moving out of the microscope's depth of focus in the <em>z</em>-direction.)
<em>Thus, for each bead at time t</em> + Δ<em>t,
we calculate the closest bead at
time t</em> (in Euclidean distance) and identify these two as the same bead.
However, if the distance is too large—greater than <em>delta</em> pixels—we assume that
one of the beads has either just begun or ended its journey.
We record the displacement that each bead travels in the 
Δ<em>t</em> units of time.

</p><p>
Write a <tt>main()</tt> method in <tt>BeadTracker.java</tt> that
takes an integer <em>min</em>, a double value <em>tau</em>, a
double value <em>delta</em>, and a
sequence of JPEG filenames as command-line arguments,
identifies the beads (using the specified values of <em>min</em> and <em>tau</em>)
in each JPEG image (using <tt>BeadFinder</tt>),
and prints 
the radial displacement that each bead
moves from one frame to the next (assuming it is no more than <em>delta</em>).

</p><blockquote><pre>% <b>java-introcs BeadTracker 25 180.0 25.0 run_1/*.jpg</b>
 7.1833
 4.7932
 2.1693
 5.5287
 5.4292
 4.3962
...
</pre></blockquote>

<em>Hint</em>: do not explicitly track a bead through a sequence of frames;
you should worry about identifying the same bead only in 
two consecutive frames.


<p><b>III. Data analysis.</b>
Einstein's theory of Brownian motion connects microscopic properties
(e.g., radius, diffusivity) of the beads to macroscopic
properties (e.g., temperature, viscosity) of the fluid in which the
beads are immersed. 
This amazing theory enables us to estimate Avogadro's number
with an ordinary microscope by observing the collective effect of
millions of water molecules on the beads.


<!--
<em>Diffusion</em> describes the random process by which particles
spread from areas of higher concentration to areas of lower concentration.
-->
<!--
<em>Diffusion</em> is the net flux (number of particles per unit area
per unit of time) that results from the random motion of particles
net flux (number of particles per unit area
per unit of time) that results from the random motion of particles
from areas of higher concentration to areas of lower concentration.
Some common examples of diffusion include pollutants diffusing
through the atmosphere, calcium diffusing through bone tissue,
and "holes" diffusing through a semiconductor.
-->

<!-- <a href = "http://www.britannica.com/nobel/micro/88_96.html">reference</a> -->

<!-- Diffusion is the physical process by which molecules intermingle
as a result of their random thermal motion. -->

<!-- 
D = 1/2d lim t -> infinity (r(t0 + t) - r(t0))^2/t.
ensemble average over all particles and all time origins
-->

</p><ul>
<p></p><li><em>Estimating the self-diffusion constant.</em>
The <em>self-diffusion constant</em> <em>D</em> characterizes the stochastic
movement of a molecule (bead) through a homogeneous medium 
(the water molecules) as a result of random thermal energy.
The Einstein–Smoluchowski equation states that the random displacement
of a bead in one dimension has a Gaussian distribution with mean zero and
variance σ<sup>2</sup> = 2 <em>D</em> Δ<em>t</em>,
where Δ<em>t</em> is the time interval between position measurements.
That is, a molecule's mean displacement is zero and 
its mean square displacement is proportional to the elapsed time between
measurements, with the constant of proportionality  2<em>D</em>.
We estimate σ<sup>2</sup>
by computing the variance of all observed bead displacements
in the <em>x</em>- and <em>y</em>-directions.
Let (Δ<em>x</em><sub>1</sub>, Δ<em>y</em><sub>1</sub>), ...,
(Δ<em>x<sub>n</sub></em>, Δ<em>y<sub>n</sub></em>)
be the <em>n</em> bead displacements, and let 
<em>r</em><sub>1</sub>, ..., <em>r<sub>n</sub></em> denote the 
radial displacements.
Then

<!--
<p>
<center>
<img src="atomic-files/atomic-variance.png" alt = "Variance estimate of displacements">
</center>
-->

<p>
</p><center>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 21.337em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.496em; height: 0px; font-size: 104%;"><span style="position: absolute; clip: rect(-0.838em 1020.32em 4.51em -999.997em); top: -2.1em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mtable" id="MathJax-Span-3" style="padding-right: 0.183em; padding-left: 0.183em;"><span style="display: inline-block; position: relative; width: 20.135em; height: 0px;"><span style="position: absolute; clip: rect(2.407em 1001.57em 6.373em -999.997em); top: -4.624em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.566em; height: 0px;"><span style="position: absolute; clip: rect(2.888em 1001.57em 4.21em -999.997em); top: -5.165em; right: 0em;"><span class="mtd" id="MathJax-Span-4"><span class="mrow" id="MathJax-Span-5"><span class="msubsup" id="MathJax-Span-6"><span style="display: inline-block; position: relative; width: 0.965em; height: 0px;"><span style="position: absolute; clip: rect(3.128em 1000.54em 4.21em -999.997em); top: -4.023em; left: 0em;"><span class="texatom" id="MathJax-Span-7"><span class="mrow" id="MathJax-Span-8"><span class="munderover" id="MathJax-Span-9"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px;"><span style="position: absolute; clip: rect(3.428em 1000.54em 4.21em -999.997em); top: -4.023em; left: 0em;"><span class="mi" id="MathJax-Span-10" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; top: -4.084em; left: 0.183em;"><span style="height: 0em; vertical-align: 0em; width: 0.364em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-11" style="font-family: STIXGeneral-Regular;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.237em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; top: -4.504em; left: 0.544em;"><span class="mn" id="MathJax-Span-12" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span></span></span><span class="mspace" id="MathJax-Span-13" style="height: 0em; vertical-align: 0em; width: 0.303em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-14" style="height: 0em; vertical-align: 0em; width: 0.303em; display: inline-block; overflow: hidden;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(3.849em 1000.6em 4.21em -999.997em); top: -2.461em; right: 0em;"><span class="mtd" id="MathJax-Span-59"><span class="mrow" id="MathJax-Span-60"><span class="mspace" id="MathJax-Span-61" style="height: 0em; vertical-align: 0em; width: 0.303em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-62" style="height: 0em; vertical-align: 0em; width: 0.303em; display: inline-block; overflow: hidden;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.63em;"></span></span><span style="position: absolute; clip: rect(3.068em 1018.57em 8.416em -999.997em); top: -6.007em; left: 1.566em;"><span style="display: inline-block; position: relative; width: 18.573em; height: 0px;"><span style="position: absolute; clip: rect(2.227em 1018.57em 4.931em -999.997em); top: -5.165em; left: 0em;"><span class="mtd" id="MathJax-Span-15"><span class="mrow" id="MathJax-Span-16"><span class="mi" id="MathJax-Span-17"></span><span class="mo" id="MathJax-Span-18" style="font-family: STIXGeneral-Regular; padding-left: 0.303em;">=</span><span class="mspace" id="MathJax-Span-19" style="height: 0em; vertical-align: 0em; width: 0.303em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-20" style="height: 0em; vertical-align: 0em; width: 0.303em; display: inline-block; overflow: hidden;"></span><span class="mfrac" id="MathJax-Span-21" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 16.409em; height: 0px; margin-right: 0.123em; margin-left: 0.123em;"><span style="position: absolute; clip: rect(3.008em 1016.23em 4.51em -999.997em); top: -4.805em; left: 50%; margin-left: -8.17em;"><span class="mrow" id="MathJax-Span-22"><span class="mo" id="MathJax-Span-23" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-24" style="font-family: STIXGeneral-Regular;">Δ</span><span class="msubsup" id="MathJax-Span-25"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.428em 1000.42em 4.21em -999.997em); top: -4.023em; left: 0em;"><span class="mi" id="MathJax-Span-26" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(3.368em 1000.42em 4.21em -999.997em); top: -4.384em; left: 0.484em;"><span class="mn" id="MathJax-Span-27" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(3.368em 1000.42em 4.21em -999.997em); top: -3.723em; left: 0.424em;"><span class="mn" id="MathJax-Span-28" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span></span></span><span class="mo" id="MathJax-Span-29" style="font-family: STIXGeneral-Regular; padding-left: 0.243em;">+</span><span class="mo" id="MathJax-Span-30" style="font-family: STIXGeneral-Regular; padding-left: 0.243em;">…</span><span class="mo" id="MathJax-Span-31" style="font-family: STIXGeneral-Regular; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-32" style="font-family: STIXGeneral-Regular; padding-left: 0.243em;">Δ</span><span class="msubsup" id="MathJax-Span-33"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.428em 1000.42em 4.21em -999.997em); top: -4.023em; left: 0em;"><span class="mi" id="MathJax-Span-34" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(3.368em 1000.42em 4.21em -999.997em); top: -4.384em; left: 0.484em;"><span class="mn" id="MathJax-Span-35" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(3.549em 1000.42em 4.21em -999.997em); top: -3.903em; left: 0.424em;"><span class="mi" id="MathJax-Span-36" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span></span></span><span class="mo" id="MathJax-Span-37" style="font-family: STIXGeneral-Regular;">)</span><span class="mspace" id="MathJax-Span-38" style="height: 0em; vertical-align: 0em; width: 0.303em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-39" style="font-family: STIXGeneral-Regular; padding-left: 0.243em;">+</span><span class="mspace" id="MathJax-Span-40" style="height: 0em; vertical-align: 0em; width: 0.303em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-41" style="font-family: STIXGeneral-Regular; padding-left: 0.243em;">(</span><span class="mi" id="MathJax-Span-42" style="font-family: STIXGeneral-Regular;">Δ</span><span class="msubsup" id="MathJax-Span-43"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.428em 1000.42em 4.39em -999.997em); top: -4.023em; left: 0em;"><span class="mi" id="MathJax-Span-44" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(3.368em 1000.42em 4.21em -999.997em); top: -4.384em; left: 0.424em;"><span class="mn" id="MathJax-Span-45" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(3.368em 1000.42em 4.21em -999.997em); top: -3.723em; left: 0.424em;"><span class="mn" id="MathJax-Span-46" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span></span></span><span class="mo" id="MathJax-Span-47" style="font-family: STIXGeneral-Regular; padding-left: 0.243em;">+</span><span class="mo" id="MathJax-Span-48" style="font-family: STIXGeneral-Regular; padding-left: 0.243em;">…</span><span class="mo" id="MathJax-Span-49" style="font-family: STIXGeneral-Regular; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-50" style="font-family: STIXGeneral-Regular; padding-left: 0.243em;">Δ</span><span class="msubsup" id="MathJax-Span-51"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.428em 1000.42em 4.39em -999.997em); top: -4.023em; left: 0em;"><span class="mi" id="MathJax-Span-52" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(3.368em 1000.42em 4.21em -999.997em); top: -4.384em; left: 0.424em;"><span class="mn" id="MathJax-Span-53" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(3.549em 1000.42em 4.21em -999.997em); top: -3.903em; left: 0.424em;"><span class="mi" id="MathJax-Span-54" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span></span></span><span class="mo" id="MathJax-Span-55" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(3.188em 1000.97em 4.21em -999.997em); top: -3.362em; left: 50%; margin-left: -0.478em;"><span class="mrow" id="MathJax-Span-56"><span class="mn" id="MathJax-Span-57" style="font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-58" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(0.844em 1016.41em 1.265em -999.997em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 16.409em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(2.227em 1007.39em 4.931em -999.997em); top: -2.461em; left: 0em;"><span class="mtd" id="MathJax-Span-63"><span class="mrow" id="MathJax-Span-64"><span class="mi" id="MathJax-Span-65"></span><span class="mo" id="MathJax-Span-66" style="font-family: STIXGeneral-Regular; padding-left: 0.303em;">=</span><span class="mspace" id="MathJax-Span-67" style="height: 0em; vertical-align: 0em; width: 0.303em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-68" style="height: 0em; vertical-align: 0em; width: 0.303em; display: inline-block; overflow: hidden;"></span><span class="mfrac" id="MathJax-Span-69" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 5.231em; height: 0px; margin-right: 0.123em; margin-left: 0.123em;"><span style="position: absolute; clip: rect(3.008em 1005.11em 4.51em -999.997em); top: -4.805em; left: 50%; margin-left: -2.581em;"><span class="mrow" id="MathJax-Span-70"><span class="msubsup" id="MathJax-Span-71"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.428em 1000.42em 4.21em -999.997em); top: -4.023em; left: 0em;"><span class="mi" id="MathJax-Span-72" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(3.368em 1000.42em 4.21em -999.997em); top: -4.384em; left: 0.484em;"><span class="mn" id="MathJax-Span-73" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(3.368em 1000.42em 4.21em -999.997em); top: -3.723em; left: 0.364em;"><span class="mn" id="MathJax-Span-74" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span></span></span><span class="mo" id="MathJax-Span-75" style="font-family: STIXGeneral-Regular; padding-left: 0.243em;">+</span><span class="mo" id="MathJax-Span-76" style="font-family: STIXGeneral-Regular; padding-left: 0.243em;">…</span><span class="mo" id="MathJax-Span-77" style="font-family: STIXGeneral-Regular; padding-left: 0.243em;">+</span><span class="msubsup" id="MathJax-Span-78" style="padding-left: 0.243em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.428em 1000.42em 4.21em -999.997em); top: -4.023em; left: 0em;"><span class="mi" id="MathJax-Span-79" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(3.368em 1000.42em 4.21em -999.997em); top: -4.384em; left: 0.484em;"><span class="mn" id="MathJax-Span-80" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(3.549em 1000.42em 4.21em -999.997em); top: -3.903em; left: 0.364em;"><span class="mi" id="MathJax-Span-81" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(3.188em 1000.97em 4.21em -999.997em); top: -3.362em; left: 50%; margin-left: -0.478em;"><span class="mrow" id="MathJax-Span-82"><span class="mn" id="MathJax-Span-83" style="font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-84" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(0.844em 1005.23em 1.265em -999.997em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.231em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.106em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.372em; border-left: 0px solid; width: 0px; height: 5.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi>σ</mi><mo stretchy="false">^</mo></mover></mrow><mn>2</mn></msup><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace></mtd><mtd><mi></mi><mo>=</mo><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mfrac><mrow><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><mo>…</mo><mo>+</mo><mi mathvariant="normal">Δ</mi><msubsup><mi>x</mi><mi>n</mi><mn>2</mn></msubsup><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mo>+</mo><mspace width="thickmathspace"></mspace><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><msubsup><mi>y</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><mo>…</mo><mo>+</mo><mi mathvariant="normal">Δ</mi><msubsup><mi>y</mi><mi>n</mi><mn>2</mn></msubsup><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><mi>n</mi></mrow></mfrac></mtd></mtr><mtr><mtd><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace></mtd><mtd><mi></mi><mo>=</mo><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mfrac><mrow><msubsup><mi>r</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><mo>…</mo><mo>+</mo><msubsup><mi>r</mi><mi>n</mi><mn>2</mn></msubsup></mrow><mrow><mn>2</mn><mi>n</mi></mrow></mfrac></mtd></mtr></mtable></math></span></span><script type="math/tex" id="MathJax-Element-1"> \begin{align}
\hat \sigma^2 \;\; & = \;\; \frac{(\Delta x_1^2 + \ldots + \Delta x_n^2) \;+\; (\Delta y_1^2 + \ldots + \Delta y_n^2)}{2n} \\
              \;\; & = \;\; \frac{r_1^2 + \ldots + r_n^2}{2n}
\end{align}
</script>
</center>

<p>
<!--
Since all 2<em>n</em> displacement measurements are statistically independent,
&sigma;<sup>2</sup> has a Chi-square distribution with 2<em>n</em> degrees of freedom.
This enables us to compute a
95% confidence interval for &sigma;<sup>2</sup> as follows:

<p>
<center>
<img src="atomic-confidence.png" alt = "Confidence interval for variance estimate of displacements">
</center>
<p>

where &chi;<sup>2</sup><sub>2n</sub>(&alpha;) is the &alpha;-quantile of a Chi-square distribution with 2n
degrees of freedom.
-->

<!-- (In Maple,  <tt>stats[statevalf,icdf,chisquare[200]](.975);</tt>.) -->

<!--
For example, if n = 100, then the confidence interval is
[0.83 &sigma;<sup>2</sup>, 1.23 &sigma;<sup>2</sup>].
Note that the confidence interval is not symmetric.
For our data, &Delta;<em>t</em> = 0.5 so this is a 95% confidence interval for 
<em>D</em> as well.
-->
For our data, Δ<em>t</em> = 0.5 so our estimate for
σ<sup>2</sup> is an estimate for <em>D</em> as well.

</p><p>Note that the radial displacements in the formula above are measured in 
meters.  The radial displacements output by your <tt>BeadTracker</tt> program are 
measured in pixels.  To convert from pixels to meters, multiply by 
 0.175 × 10<sup>−6</sup> (meters per pixel).

<!-- <p>The value <em>n</em> is the total number of displacements read. -->


</p><p></p></li><li><em>Estimating the Boltzmann constant.</em> 
The Stokes–Einstein relation asserts that the self-diffusion constant of
a spherical particle immersed in a fluid is given by

<!--
<p>
<center>
<img src="atomic-files/atomic-stokeseinstein.png" alt = "Stokes-Einstein relation">
</center>
-->

<p>
</p><center>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-85" style="width: 5.171em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.931em; height: 0px; font-size: 104%;"><span style="position: absolute; clip: rect(1.025em 1004.93em 3.669em -999.997em); top: -2.581em; left: 0em;"><span class="mrow" id="MathJax-Span-86"><span class="mi" id="MathJax-Span-87" style="font-family: STIXGeneral-Italic;">D</span><span class="mo" id="MathJax-Span-88" style="font-family: STIXGeneral-Regular; padding-left: 0.303em;">=</span><span class="mstyle" id="MathJax-Span-89" style="padding-left: 0.303em;"><span class="mrow" id="MathJax-Span-90"><span class="mfrac" id="MathJax-Span-91"><span style="display: inline-block; position: relative; width: 2.707em; height: 0px; margin-right: 0.123em; margin-left: 0.123em;"><span style="position: absolute; clip: rect(3.188em 1001.26em 4.21em -999.997em); top: -4.684em; left: 50%; margin-left: -0.658em;"><span class="mrow" id="MathJax-Span-92"><span class="mi" id="MathJax-Span-93" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mspace" id="MathJax-Span-94" style="height: 0em; vertical-align: 0em; width: 0.183em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-95" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(3.188em 1002.53em 4.39em -999.997em); top: -3.362em; left: 50%; margin-left: -1.259em;"><span class="mrow" id="MathJax-Span-96"><span class="mn" id="MathJax-Span-97" style="font-family: STIXGeneral-Regular;">6</span><span class="mspace" id="MathJax-Span-98" style="height: 0em; vertical-align: 0em; width: 0.183em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-99" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mspace" id="MathJax-Span-100" style="height: 0em; vertical-align: 0em; width: 0.183em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-101" style="font-family: STIXGeneral-Italic;">η</span><span class="mspace" id="MathJax-Span-102" style="height: 0em; vertical-align: 0em; width: 0.183em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-103" style="font-family: STIXGeneral-Italic;">ρ</span></span><span style="display: inline-block; width: 0px; height: 4.029em;"></span></span><span style="position: absolute; clip: rect(0.844em 1002.71em 1.265em -999.997em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.707em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.587em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.997em; border-left: 0px solid; width: 0px; height: 2.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>k</mi><mspace width="thinmathspace"></mspace><mi>T</mi></mrow><mrow><mn>6</mn><mspace width="thinmathspace"></mspace><mi>π</mi><mspace width="thinmathspace"></mspace><mi>η</mi><mspace width="thinmathspace"></mspace><mi>ρ</mi></mrow></mfrac></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-2">D = \dfrac{k \, T}{6 \, \pi \, \eta \, \rho}</script>
</center>



where, for our data,

<!-- pixels per micron = 5.7 -->

<ul>

<p></p><li> <em>T</em> = absolute temperature = 297 Kelvin (room temperature)

<!-- <p><li> F = # JPEG frames = 200 per run. -->

<p></p></li><li> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-104" style="width: 0.544em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.484em; height: 0px; font-size: 104%;"><span style="position: absolute; clip: rect(1.986em 1000.42em 2.948em -999.997em); top: -2.581em; left: 0em;"><span class="mrow" id="MathJax-Span-105"><span class="mi" id="MathJax-Span-106" style="font-family: STIXGeneral-Italic;">η</span></span><span style="display: inline-block; width: 0px; height: 2.587em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>η</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">\eta</script>
<!--
<img src="atomic-files/eta.png" style="position:relative;top:4px;margin-right:0px">
-->
 = viscosity of water at room temperature = 9.135 × 10<sup>−4</sup> 
N·s·m<sup>−2</sup>

<p></p></li><li> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C1;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-107" style="width: 0.544em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.484em; height: 0px; font-size: 104%;"><span style="position: absolute; clip: rect(1.986em 1000.42em 2.948em -999.997em); top: -2.581em; left: 0em;"><span class="mrow" id="MathJax-Span-108"><span class="mi" id="MathJax-Span-109" style="font-family: STIXGeneral-Italic;">ρ</span></span><span style="display: inline-block; width: 0px; height: 2.587em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ρ</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">\rho</script>
<!-- <img src="atomic-files/rho.png" style="position:relative;top:5px;margin-right:0px"> -->
 = radius of bead = 0.5 × 10<sup>−6</sup> meters

<!--<p><Li> <span style="font-family:courier">&rho;</span> = radius of bead = 0.5 * 10<sup>-6</sup> meters-->

<!-- Diameter of bead = 1*10<sup>-6</sup> meters. -->
<!-- Diameter of bead = 1*10<sup>-6</sup> meters. -->
<!-- 1 micron -->

</li></ul>

<p>
and <em>k</em> is the <em>Boltzmann constant</em>.
All parameters are given in SI units.
The Boltzmann constant is a
fundamental physical constant that relates the average kinetic
energy of a molecule to its temperature.
We estimate <em>k</em> by measuring all of the
parameters in the Stokes–Einstein equation, and solving for <em>k</em>.

<!-- 
Friction coefficient &mu; of a fluid can be experimentally computed by
observing the terminal velocity of particles moving through it.
-->

</p><p></p></li><li><em>Estimating Avogadro's number.</em>
<em>Avogadro's number</em> <em>N<sub>A</sub></em>
is defined to be the number of particles in a mole.
By definition, <em>k = R / N<sub>A</sub></em>, where 
the universal gas constant <em>R</em>
is approximately 8.31446.
<!-- J&middot;mol<sup>&minus;1</sup>&middot;K<sup>&minus;1</sup>.-->
<!-- <em>R</em> is the constant of proportionality in the ideal gas
law <em>PV = nRT</em> -->
Use <em>R / k</em> as an estimate of Avogadro's number.
</li></ul>

<p>
For the final part, write a <tt>main()</tt> method in <tt>Avogadro.java</tt> 
that reads the displacements from standard input
and estimates Boltzmann's constant
and Avogadro's number using the formulas described above.

</p><blockquote><pre>% <b>more displacements-run_1.txt</b>        % <b>java-introcs BeadTracker 25 180.0 25.0 run_1/*.jpg | java-introcs Avogadro</b>
 7.1833                               Boltzmann = 1.2535e-23
 4.7932                               Avogadro  = 6.6329e+23
 2.1693
 5.5287
 5.4292  
 4.3962
...

% <b>java-introcs Avogadro &lt; displacements-run_1.txt</b>
Boltzmann = 1.2535e-23
Avogadro  = 6.6329e+23
</pre></blockquote>


<p>
<b>Output format.</b>
Use four digits of precision after the decimal point, both in <tt>BeadTracker</tt>
and <tt>Avogadro</tt>.

</p><p>
<b>Running-time analysis.</b> 
Formulate a hypothesis for the running time (in seconds) of
<tt>BeadTracker</tt> as a function of the input size <em>n</em>
(total number of pixels read in across all frames being processed).
Justify your hypothesis in your <tt>readme.txt</tt> file with empirical
data.


</p><p>
<b>Provided files. </b>
You can download the datasets and other helper files as
<a href="ftp://ftp.cs.princeton.edu/pub/cs126/atomic.zip">atomic.zip</a> (67 MB).
<!--
(You can alternatively use <a href = "ftp://ftp.cs.princeton.edu/pub/cs126/atomic">the course FTP site</a>.)
-->

</p><p>
<b>Submission. </b> 
Submit <tt>Blob.java</tt>, <tt>BeadFinder.java</tt>, <tt>BeadTracker.java</tt>
and <tt>Avogadro.java</tt>.
You may assume access to <tt>stdlib.jar</tt>, <tt>Luminance.java</tt>,
<tt>Stack.java</tt>, <tt>Queue.java</tt>, and <tt>ST.java</tt>.
Finally, submit a
<a href="ftp://ftp.cs.princeton.edu/pub/cs126/atomic/readme.txt">readme.txt</a>
file (or <a href="ftp://ftp.cs.princeton.edu/pub/cs126/atomic/partner/readme.txt">partner readme</a> file)
and answer the questions, including the running-time analysis.
<!--
If your program has any dependencies, submit them as well.
However, you do not need to upload
the <a href="http://introcs.cs.princeton.edu/java/stdlib/">standard libraries</a>, <a href="http://introcs.cs.princeton.edu/java/31datatype/"><tt>Luminance.java</tt></a>, or the data types from <a href="http://introcs.cs.princeton.edu/java/43stack/index.php">Section 4.3</a>.
-->
</p><p>

</p><hr>
<small><i> This assignment was created by David Botstein, Tamara Broderick,
Ed Davisson, Daniel Marlow, William Ryu, and Kevin Wayne.
</i></small>
<address><small>Copyright © 2005
</small>
</address>

<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, sans-serif;"></div></div></body></html>